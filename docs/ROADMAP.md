# invoice-web 개발 로드맵

Notion 데이터베이스의 견적서를 클라이언트가 고유 URL로 확인하고 PDF로 다운로드하는 Next.js 기반 웹 서비스

## 프로젝트 개요

**핵심 기능**:
- 발급자가 Notion에 입력한 견적서를 자동으로 웹에서 조회
- 클라이언트가 고유 URL로 견적서를 확인하고 PDF 다운로드
- 발급자 전용 인증 및 견적서 목록 관리

**기술 스택**:
- Next.js 15.5.3 (App Router) + React 19 + TypeScript 5
- TailwindCSS v4 + shadcn/ui
- React Hook Form + Zod
- Notion API + Server Actions
- 배포: Vercel

---

## 개발 단계별 계획

### Phase 1: 프로젝트 초기 설정 (골격 구축)

**목표**: 개발 환경 설정 및 기본 구조 완성

**소요 시간**: 약 4시간

**왜 먼저 해야 하는가**:
- 모든 개발의 기반이 되므로 초기에 올바르게 설정해야 함
- 의존성과 도구 설정이 뒤에 가면 기존 코드 수정 비용이 크다
- 타입 정의가 미리 되어야 개발 중 타입 안전성 보장

#### Task 001: Next.js 초기 설정 및 의존성 설치

**할 작업**:
- [ ] Next.js 15.5.3 프로젝트 초기화 (App Router, Turbopack)
- [ ] TypeScript, TailwindCSS v4 설정
- [ ] shadcn/ui (new-york style) 설치
- [ ] React Hook Form, Zod 설치
- [ ] @notionhq/client 설치
- [ ] ESLint, Prettier, Husky, lint-staged 설정
- [ ] npm run dev/build 명령어 동작 확인

**완료 기준**:
- 프로젝트 폴더에서 `npm run dev` 실행 시 정상 동작
- 기본 페이지가 브라우저에서 렌더링됨

---

#### Task 002: 라우트 구조 및 타입 정의

**할 작업**:
- [ ] Next.js App Router 라우트 구조 생성
  - `/` (루트 - 로그인으로 리디렉션)
  - `/login` (로그인 페이지)
  - `/invoices` (견적서 목록 - 인증 필수)
  - `/invoices/[id]` (견적서 상세)
  - `not-found.tsx` (404 페이지)
- [ ] 모든 페이지에 빈 컴포넌트 생성 (기본 구조만)
- [ ] TypeScript 타입 정의 파일 작성 (`src/types/invoice.ts`)
  - Invoice, InvoiceItem, CompanyProfile 등
- [ ] 환경변수 정의 및 검증 (`src/lib/env.ts`)
  - NOTION_API_KEY, NOTION_DATABASE_ID
- [ ] 공통 유틸리티 함수 작성 (`src/lib/utils.ts`)

**완료 기준**:
- 모든 라우트에서 페이지 로드 가능
- TypeScript 타입 오류 없음
- 환경변수 검증 동작 확인

---

#### Task 003: 루트 레이아웃 및 404 페이지 구현

**할 작업**:
- [ ] 루트 레이아웃 컴포넌트 작성 (`src/app/layout.tsx`)
  - 공통 메타데이터 설정
  - ThemeProvider (다크/라이트 모드) 구성
  - 전역 CSS 적용
- [ ] 404 페이지 구현 (`src/app/not-found.tsx`)
  - 오류 메시지 및 홈 이동 링크
- [ ] 루트 페이지 리디렉션 (`src/app/page.tsx` → `/login`)
- [ ] 레이아웃 컨테이너 컴포넌트 작성 (반응형 사이즈 옵션)

**완료 기준**:
- 모든 페이지에서 공통 레이아웃 적용 확인
- 존재하지 않는 경로 접근 시 404 페이지 표시
- 루트 URL 접근 시 로그인 페이지로 리디렉션

---

### Phase 2: 공통 모듈/컴포넌트 개발

**목표**: 재사용 가능한 UI 컴포넌트 및 유틸리티 완성

**소요 시간**: 약 3시간

**왜 먼저 해야 하는가**:
- 각 페이지가 공통 컴포넌트를 사용하므로 미리 완성해야 함
- 컴포넌트를 먼저 만들면 페이지 개발 속도가 빨라짐
- 디자인 일관성을 보장할 수 있음

#### Task 004: shadcn/ui 컴포넌트 설치 및 커스터마이징

**할 작업**:
- [ ] 필요한 shadcn/ui 컴포넌트 설치:
  - Button, Card, Input, Label, Form, Badge
  - Dialog, Dropdown Menu, Select, Separator
  - Sheet, Skeleton, Avatar, Navigation Menu, Toast
- [ ] Lucide Icons 설정 및 확인
- [ ] 기본 스타일 커스터마이징 (색상, 폰트 등)
- [ ] 컴포넌트별 사용 예시 정리

**완료 기준**:
- 모든 컴포넌트 정상 렌더링
- 프로젝트 스타일 적용 완료
- 컴포넌트 라이브러리 사용 가능

---

#### Task 005: 재사용 컴포넌트 개발

**할 작업**:
- [ ] 로그인 폼 컴포넌트 (`src/components/login-form.tsx`)
  - React Hook Form + Zod 검증
  - 이메일/비밀번호 입력 필드
  - 비밀번호 표시/숨기기 토글
  - 로딩 상태 및 오류 메시지
- [ ] 상태 배지 컴포넌트 (초안/발송/승인/거절)
- [ ] 견적서 테이블 헤더/로우 컴포넌트
- [ ] 로딩 스켈레톤 UI

**완료 기준**:
- 모든 컴포넌트가 독립적으로 동작
- TypeScript 타입 안전성 확보
- 마크업 구조 검증 완료

---

### Phase 3: 핵심 기능 개발

**목표**: Notion API 연동 및 사용자 기능 완성

**소요 시간**: 약 12시간

**왜 먼저 해야 하는가**:
- 데이터 연동이 없으면 앱이 작동하지 않음
- 사용자가 체감할 수 있는 기능이 이 단계에서 완성됨
- 이후 최적화는 이 단계가 완료된 후 진행 가능

#### Task 006: Notion API 클라이언트 및 Server Actions 구현

**할 작업**:
- [ ] Notion 클라이언트 초기화 (`src/lib/notion.ts`)
  - @notionhq/client 설정
- [ ] Server Actions 정의 (`src/app/actions/`)
  - `getInvoices()`: 전체 견적서 목록 조회
  - `getInvoiceById(id)`: 개별 견적서 상세 조회
  - `loginUser(email, password)`: 발급자 인증
- [ ] Notion 데이터를 TypeScript 타입으로 변환하는 매퍼 함수
- [ ] 에러 핸들링 (API 오류, 네트워크 오류 등)
- [ ] 테스트: Playwright MCP로 API 응답 검증

**예상 소요 시간**: 약 3시간

**완료 기준**:
- Notion 데이터 정상 조회
- Server Actions 동작 확인
- 에러 발생 시 적절한 처리
- 모든 테스트 통과

---

#### Task 007: 로그인 페이지 구현 (F010)

**할 작업**:
- [ ] 로그인 페이지 레이아웃 (`src/app/login/page.tsx`)
- [ ] 로그인 폼 연결 (이메일/비밀번호 입력)
- [ ] Server Action과 연결하여 인증 로직 구현
- [ ] 로그인 성공 시 쿠키/세션 생성
- [ ] 로그인 성공 시 `/invoices` 리디렉션
- [ ] 로그인 실패 시 오류 메시지 표시
- [ ] 테스트: Playwright MCP로 로그인 플로우 검증

**예상 소요 시간**: 약 2시간

**완료 기준**:
- 유효한 자격증명으로 로그인 성공
- 잘못된 자격증명으로 로그인 실패 시 오류 메시지 표시
- 로그인 후 쿠키 생성 확인
- 모든 테스트 통과

---

#### Task 008: 인증 미들웨어 및 보호된 경로 설정

**할 작업**:
- [ ] 미들웨어 작성 (`src/middleware.ts`)
  - `/invoices` 경로 보호 (인증 확인)
  - 미인증 상태에서 접근 시 `/login` 리디렉션
- [ ] 쿠키 기반 세션 관리
- [ ] 로그아웃 Server Action 구현
- [ ] 테스트: 미인증 접근 시 리디렉션 확인

**예상 소요 시간**: 약 1.5시간

**완료 기준**:
- 미인증 사용자의 `/invoices` 접근 시 로그인 페이지로 리디렉션
- 로그아웃 후 쿠키 삭제 확인
- 세션 만료 처리

---

#### Task 009: 견적서 목록 페이지 UI 및 기능 (F001, F011)

**할 작업**:
- [ ] 견적서 목록 페이지 레이아웃 (`src/app/invoices/page.tsx`)
  - Notion API로 견적서 목록 조회
  - 테이블/카드 뷰로 목록 표시
- [ ] 견적서별 정보 표시:
  - 견적서 번호, 클라이언트명, 발급일, 금액, 상태
- [ ] 상태별 배지 표시 (초안/발송/승인/거절)
- [ ] 발급자 헤더 (로고, 로그아웃 버튼)
- [ ] 빈 목록 상태 UI
- [ ] 로딩 상태 (Suspense + Skeleton)
- [ ] URL 복사 기능 (클립보드 API)
- [ ] 테스트: Playwright MCP로 목록 데이터 로딩 검증

**예상 소요 시간**: 약 3시간

**완료 기준**:
- 견적서 목록이 정상적으로 표시됨
- 상태 배지 색상 정확함
- URL 복사 기능 동작
- 로딩 상태 표시 확인
- 모든 테스트 통과

---

#### Task 010: 견적서 상세 페이지 UI 및 기능 (F001-F005)

**할 작업**:
- [ ] 견적서 상세 페이지 레이아웃 (`src/app/invoices/[id]/page.tsx`)
  - Notion API로 해당 견적서 조회
  - 유효하지 않은 ID 접근 시 404 처리
- [ ] 견적서 콘텐츠 표시:
  - 헤더: 로고, 회사 정보, 견적서 번호, 발급일, 유효기간
  - 클라이언트 정보: 수신자명, 연락처
  - 견적 항목 테이블: 품목명, 수량, 단가, 소계
  - 금액 요약: 소계, 세금(VAT 10%), 총액
  - 상태 배지
  - 메모 섹션 (선택 표시)
- [ ] PDF 다운로드 버튼 (인쇄 레이아웃 기반)
- [ ] 인쇄 전용 CSS (`@media print`) 설정
  - 불필요한 UI 요소 숨김
  - 페이지 여백 및 레이아웃 조정
- [ ] 동적 메타데이터 생성 (Open Graph, 견적서 번호)
- [ ] 테스트: Playwright MCP로 상세 페이지 데이터 렌더링 검증

**예상 소요 시간**: 약 4시간

**완료 기준**:
- 견적서 데이터가 정확하게 표시됨
- 유효하지 않은 ID 접근 시 404 페이지 표시
- 모든 필드가 올바르게 렌더링됨
- 인쇄 레이아웃이 PDF로 정상 변환됨
- 모든 테스트 통과

---

#### Task 011: PDF 다운로드 기능 구현 (F005)

**할 작업**:
- [ ] PDF 다운로드 버튼 동작 구현
  - `window.print()` 기반 구현
- [ ] 인쇄 전용 CSS 최적화
  - 헤더/푸터 정보 설정
  - 페이지 나누기 처리
  - 색상 및 폰트 최적화
- [ ] 브라우저 호환성 확인 (Chrome, Safari, Firefox)
- [ ] 테스트: Playwright MCP로 PDF 다운로드 버튼 동작 검증

**예상 소요 시간**: 약 1.5시간

**완료 기준**:
- PDF 다운로드 버튼 클릭 시 브라우저 인쇄 다이얼로그 열림
- PDF로 저장 시 전체 콘텐츠가 깔끔하게 표시됨
- 모든 브라우저에서 동작 확인
- 모든 테스트 통과

---

#### Task 012: 반응형 디자인 및 사용자 플로우 검증

**할 작업**:
- [ ] 모바일/태블릿/데스크톱 반응형 테스트
  - 견적서 목록 테이블 모바일 대응
  - 견적서 상세 페이지 모바일 레이아웃
  - 견적서 항목 테이블 모바일 스크롤
- [ ] 다크 모드/라이트 모드 테마 일관성
- [ ] 전체 사용자 플로우 검증
  - 발급자: 로그인 → 목록 → 상세 → 로그아웃
  - 클라이언트: 고유 URL → 상세 보기 → PDF 다운로드
- [ ] 접근성 검증 (ARIA, 키보드 네비게이션)
- [ ] 테스트: Playwright MCP로 전체 플로우 E2E 테스트

**예상 소요 시간**: 약 2시간

**완료 기준**:
- 모든 화면 크기에서 정상 렌더링
- 모든 기능이 모바일에서 동작
- 테마 전환 시 모든 페이지 일관성 유지
- 모든 사용자 플로우 검증 완료
- 모든 테스트 통과

---

### Phase 4: 추가 기능 및 최적화

**목표**: 에러 처리, 성능 개선, 배포 준비

**소요 시간**: 약 5시간

**왜 마지막에 해야 하는가**:
- 핵심 기능이 완성된 후에야 최적화 효과를 측정할 수 있음
- 배포는 모든 기능이 완성된 후 진행해야 함

#### Task 013: 에러 처리 및 로딩 상태 개선

**할 작업**:
- [ ] Notion API 에러 핸들링 개선
  - API 연결 실패 시 사용자 친화적 메시지
  - 타임아웃 처리
  - 재시도 로직 (필요 시)
- [ ] 404 페이지 개선
  - 유효하지 않은 ID 접근 시 구체적 메시지
- [ ] 로딩 상태 UI 개선
  - 목록 로딩 중 스켈레톤 표시
  - 상세 페이지 로딩 중 스켈레톤 표시
- [ ] 빈 상태(Empty State) UI
  - 견적서 목록이 비어있을 때 안내 메시지
- [ ] 테스트: 에러 시나리오별 동작 검증

**예상 소요 시간**: 약 2시간

**완료 기준**:
- API 오류 시 사용자 친화적 메시지 표시
- 로딩 상태가 명확하게 표시됨
- 빈 상태일 때 안내 메시지 표시
- 모든 에러 시나리오 테스트 통과

---

#### Task 014: 성능 최적화 및 캐싱

**할 작업**:
- [ ] Next.js 캐싱 전략 적용
  - `revalidatePath` / `revalidateTag` 활용
  - Notion API 응답 캐싱
- [ ] 번들 크기 분석 및 최적화
- [ ] 이미지 최적화 (로고 등)
- [ ] 메타데이터 최적화
- [ ] Lighthouse 성능 점수 확인 (목표: 90점 이상)

**예상 소요 시간**: 약 1.5시간

**완료 기준**:
- Lighthouse 성능 점수 90점 이상
- 캐싱 전략 적용 확인
- 번들 크기 최적화 완료

---

#### Task 015: Vercel 배포 및 환경 설정

**할 작업**:
- [ ] Vercel 프로젝트 생성 및 연결
- [ ] 환경변수 설정
  - NOTION_API_KEY
  - NOTION_DATABASE_ID
- [ ] 프로덕션/프리뷰 환경 분리 (필요 시)
- [ ] 커스텀 도메인 설정 (선택)
- [ ] 배포 후 전체 기능 검증
  - 로그인 플로우
  - 목록 조회
  - 상세 페이지
  - PDF 다운로드

**예상 소요 시간**: 약 1.5시간

**완료 기준**:
- 프로덕션 환경에서 모든 기능 동작
- HTTPS 적용 확인
- 환경변수 정상 로드
- 배포 후 전체 기능 테스트 통과

---

### Phase 5: 최종 검증 및 문서화

**목표**: 품질 보증 및 프로젝트 완료

**소요 시간**: 약 3시간

#### Task 016: 통합 테스트 및 품질 검증

**할 작업**:
- [ ] 전체 사용자 플로우 E2E 테스트 (Playwright MCP)
  - 발급자 플로우: 로그인 → 목록 조회 → 상세 보기 → URL 복사 → 로그아웃
  - 클라이언트 플로우: 고유 URL 접근 → 견적서 확인 → PDF 다운로드
- [ ] 엣지 케이스 테스트
  - 빈 견적서 목록
  - 메모 없는 견적서
  - 긴 항목 목록
  - 특수 문자 포함 데이터
- [ ] 크로스 브라우저 테스트 (Chrome, Safari, Firefox)
- [ ] 모바일 기기 테스트

**완료 기준**:
- 모든 플로우 테스트 통과
- 모든 엣지 케이스 처리 확인
- 크로스 브라우저 호환성 검증 완료

---

#### Task 017: 문서화 및 프로젝트 완료

**할 작업**:
- [ ] README.md 작성
  - 프로젝트 소개
  - 설치 방법
  - 환경변수 설정
  - 배포 방법
- [ ] API 문서화 (Server Actions)
- [ ] 컴포넌트 라이브러리 문서화
- [ ] 개발 가이드 작성
- [ ] 변경 로그(CHANGELOG.md) 작성
- [ ] 프로젝트 최종 정리

**완료 기준**:
- 모든 문서 작성 완료
- README 및 가이드 검토 완료
- 프로젝트 최종 상태 확인

---

## 마일스톤

| 마일스톤 | Phase | 예상 완료 | 완료 기준 |
|---------|-------|---------|----------|
| M1: 개발 환경 완성 | Phase 1 | 4시간 | 라우트 구조, 타입 정의, 기본 레이아웃 완성 |
| M2: 공통 컴포넌트 완성 | Phase 2 | 7시간 | 재사용 가능한 UI 컴포넌트 및 유틸리티 완성 |
| M3: 핵심 기능 완성 | Phase 3 | 19시간 | Notion API 연동, 인증, PDF 다운로드 동작 |
| M4: 최적화 및 배포 | Phase 4 | 24시간 | 성능 최적화, Vercel 배포, 전체 기능 검증 |
| M5: 프로젝트 완료 | Phase 5 | 27시간 | 전체 테스트 통과, 문서화 완료 |

---

## 기능-Task 매핑

| 기능 ID | 기능명 | 관련 Task | Phase |
|---------|--------|----------|-------|
| F001 | Notion 견적서 조회 | Task 006, 009, 010 | 3 |
| F002 | 고유 URL 견적서 접근 | Task 010 | 3 |
| F003 | 견적서 상세 표시 | Task 010 | 3 |
| F004 | 견적서 상태 표시 | Task 009, 010 | 3 |
| F005 | PDF 다운로드 | Task 010, 011 | 3 |
| F010 | 발급자 인증 | Task 007, 008 | 3 |
| F011 | 견적서 목록 관리 | Task 009 | 3 |

---

## 페이지-Task 매핑

| 페이지 | 관련 Task | 핵심 기능 |
|--------|----------|---------|
| 로그인 | Task 007, 008 | F010 |
| 견적서 목록 | Task 009, 012 | F001, F011 |
| 견적서 상세 | Task 010, 011, 012 | F001-F005 |
| 404 | Task 003 | 오류 처리 |

---

## 예상 총 소요 시간

- **Phase 1**: 약 4시간
- **Phase 2**: 약 3시간
- **Phase 3**: 약 12시간
- **Phase 4**: 약 5시간
- **Phase 5**: 약 3시간

**전체 예상 시간**: 약 27시간 (개발자 1명 기준)

---

## 개발 시 주의사항

### 필수 사항

1. **테스트 수행 필수**
   - API 구현 후 즉시 Playwright MCP로 테스트
   - 테스트 없이 다음 Task 진행 금지
   - 테스트 실패 시 코드 수정 후 재테스트

2. **TypeScript 타입 안전성**
   - `any` 타입 사용 금지
   - 모든 함수 매개변수와 반환값에 타입 명시

3. **Server Actions 사용**
   - Notion API 호출은 반드시 Server Actions 사용
   - 클라이언트에서 API 키 노출 금지

4. **환경변수 관리**
   - `src/lib/env.ts`를 통해서만 환경변수 접근
   - 프로덕션에서도 동일한 방식 적용

5. **커밋 및 문서화**
   - 각 Task 완료 후 커밋
   - 커밋 메시지는 한국어로 작성
   - 주요 코드에 한국어 주석 추가
