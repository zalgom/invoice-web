# invoice-web MVP PRD

## 핵심 정보

**목적**: Notion 데이터베이스에 입력된 견적서를 클라이언트가 고유 URL로 웹에서 바로 확인하고 PDF로 다운로드할 수 있게 한다
**사용자**: 견적서를 Notion에 입력하는 발급자(관리자) + 고유 URL로 견적서를 조회하는 수신자(클라이언트)

---

## 사용자 여정

```
1. [견적서 목록 페이지] (발급자 전용)
   ↓ Notion 데이터베이스에서 견적서 불러오기

2. [견적서 상세 페이지] (/invoices/[id])
   ↓ 발급자가 클라이언트에게 URL 전달

   [클라이언트 접근] → [견적서 상세 페이지] → 내용 확인
   [PDF 다운로드 클릭] → [브라우저 PDF 저장]

3. [견적서 상세 페이지]
   ↓ 상태별 표시 (초안 / 발송 / 승인 / 거절)

4. [완료]
   → 클라이언트: PDF 다운로드 또는 페이지 종료
   → 발급자: 목록 페이지 복귀
```

---

## 기능 명세

### 1. MVP 핵심 기능

| ID       | 기능명               | 설명                                               | MVP 필수 이유                                      | 관련 페이지                            |
| -------- | -------------------- | -------------------------------------------------- | -------------------------------------------------- | -------------------------------------- |
| **F001** | Notion 견적서 조회   | Notion API를 통해 견적서 데이터를 불러옴           | 별도 DB 없이 Notion을 단일 데이터 소스로 활용      | 견적서 목록 페이지, 견적서 상세 페이지 |
| **F002** | 고유 URL 견적서 접근 | `/invoices/[id]`로 특정 견적서에 직접 접근         | 클라이언트가 로그인 없이 자신의 견적서만 조회 가능 | 견적서 상세 페이지                     |
| **F003** | 견적서 상세 표시     | 클라이언트명, 항목, 금액, 상태 등 전체 정보 표시   | 견적서 핵심 내용을 웹에서 시각적으로 전달          | 견적서 상세 페이지                     |
| **F004** | 견적서 상태 표시     | 초안 / 발송 / 승인 / 거절 4가지 상태를 배지로 표시 | 클라이언트가 현재 처리 단계를 즉시 파악            | 견적서 상세 페이지                     |
| **F005** | PDF 다운로드         | 현재 견적서 페이지를 PDF로 저장                    | 클라이언트의 견적서 보관 및 내부 결재 지원         | 견적서 상세 페이지                     |

### 2. MVP 필수 지원 기능

| ID       | 기능명           | 설명                                        | MVP 필수 이유                                 | 관련 페이지                       |
| -------- | ---------------- | ------------------------------------------- | --------------------------------------------- | --------------------------------- |
| **F010** | 발급자 인증      | 관리자 로그인/로그아웃 (Notion API 키 기반) | 발급자만 견적서 목록에 접근하도록 보호        | 로그인 페이지, 견적서 목록 페이지 |
| **F011** | 견적서 목록 관리 | Notion DB의 전체 견적서 목록 및 상태 일람   | 발급자가 어떤 견적서를 발행했는지 한눈에 파악 | 견적서 목록 페이지                |

### 3. MVP 이후 기능 (제외)

- 견적서 직접 생성/수정/삭제 (Notion에서 직접 관리)
- 클라이언트 계정 생성 및 인증
- 이메일 발송 자동화
- 견적서 승인/거절 버튼 (클라이언트 액션)
- 알림 시스템
- 견적서 템플릿 관리
- 다국어 지원

---

## 메뉴 구조

```
invoice-web 내비게이션

비로그인 사용자 (클라이언트)
└── 견적서 상세 페이지 (/invoices/[id])
    └── 기능: F001, F002, F003, F004, F005

발급자 메뉴 (로그인 후)
├── 견적서 목록 - F011
│   └── 기능: F001, F010, F011 (전체 견적서 일람)
└── 로그아웃
    └── 기능: F010

공용 접근
└── 로그인 페이지
    └── 기능: F010 (발급자 전용)
```

---

## 페이지별 상세 기능

### 로그인 페이지

> **구현 기능:** `F010` | **접근:** 비인증 상태에서 발급자 메뉴 진입 시

| 항목            | 내용                                                                                                                                              |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 발급자(관리자) 전용 인증 진입점                                                                                                                   |
| **진입 경로**   | 직접 URL 접근 또는 견적서 목록 페이지 리디렉션                                                                                                    |
| **사용자 행동** | 이메일/비밀번호 입력 후 로그인 버튼 클릭                                                                                                          |
| **주요 기능**   | • 이메일 + 비밀번호 입력 폼 (React Hook Form + Zod 검증)<br>• 입력값 유효성 실시간 표시<br>• 로그인 실패 시 오류 메시지 표시<br>• **로그인** 버튼 |
| **다음 이동**   | 성공 → 견적서 목록 페이지, 실패 → 오류 메시지 표시 후 유지                                                                                        |

---

### 견적서 목록 페이지

> **구현 기능:** `F001`, `F010`, `F011` | **인증:** 발급자 로그인 필수

| 항목            | 내용                                                                                                                                                                                                           |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 발급자가 Notion에서 불러온 전체 견적서를 관리하는 대시보드                                                                                                                                                     |
| **진입 경로**   | 로그인 성공 후 자동 리디렉션, 또는 헤더 메뉴 클릭                                                                                                                                                              |
| **사용자 행동** | 견적서 목록 확인, 특정 견적서 클릭하여 상세 보기, 클라이언트 공유 URL 복사                                                                                                                                     |
| **주요 기능**   | • Notion API 연동 견적서 목록 테이블 표시<br>• 견적서별 클라이언트명, 금액, 상태, 발급일 요약 표시<br>• 상태별 배지 (초안 / 발송 / 승인 / 거절)<br>• 견적서 상세 페이지 링크 복사 버튼<br>• **상세 보기** 버튼 |
| **다음 이동**   | 행 클릭 또는 버튼 → 견적서 상세 페이지                                                                                                                                                                         |

---

### 견적서 상세 페이지

> **구현 기능:** `F001`, `F002`, `F003`, `F004`, `F005` | **인증:** 없음 (고유 URL로 접근)

| 항목            | 내용                                                                                                                                                                                                                                                                                                             |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 클라이언트가 자신의 견적서를 확인하고 PDF로 저장하는 핵심 페이지                                                                                                                                                                                                                                                 |
| **진입 경로**   | 고유 URL(`/invoices/[id]`) 직접 접근 또는 목록 페이지에서 이동                                                                                                                                                                                                                                                   |
| **사용자 행동** | 견적서 전체 내용 확인, 상태 확인, PDF 다운로드 버튼 클릭                                                                                                                                                                                                                                                         |
| **주요 기능**   | • 견적서 헤더: 로고, 회사 정보, 견적서 번호, 발급일, 유효기간<br>• 클라이언트 정보 섹션: 수신자명, 연락처<br>• 견적 항목 테이블: 품목명, 수량, 단가, 소계<br>• 금액 요약: 소계, 세금, 총액<br>• 상태 배지 (초안 / 발송 / 승인 / 거절)<br>• 메모 섹션 (선택 표시)<br>• **PDF 다운로드** 버튼 (인쇄 레이아웃 기반) |
| **다음 이동**   | PDF 다운로드 → 브라우저 저장 다이얼로그, 잘못된 ID → 404 페이지                                                                                                                                                                                                                                                  |

---

### 404 페이지

> **구현 기능:** 없음 | **인증:** 없음

| 항목            | 내용                                                            |
| --------------- | --------------------------------------------------------------- |
| **역할**        | 존재하지 않는 견적서 ID 또는 잘못된 URL 접근 시 안내            |
| **진입 경로**   | 유효하지 않은 `/invoices/[id]` 접근 또는 존재하지 않는 경로     |
| **사용자 행동** | 오류 내용 확인 후 홈 또는 이전 페이지로 복귀                    |
| **주요 기능**   | • "견적서를 찾을 수 없습니다" 안내 메시지<br>• 홈으로 이동 링크 |
| **다음 이동**   | 홈 버튼 → 로그인 페이지                                         |

---

## 데이터 모델

### Invoice (견적서)

Notion 데이터베이스를 단일 데이터 소스로 사용하며, 아래 필드를 Notion 속성으로 관리합니다.

| 필드          | 설명                           | 타입/관계                        |
| ------------- | ------------------------------ | -------------------------------- |
| id            | Notion 페이지 고유 ID          | UUID (Notion 자동 생성)          |
| invoiceNumber | 견적서 번호 (예: INV-2025-001) | string                           |
| clientName    | 클라이언트명                   | string                           |
| issueDate     | 발급일                         | date                             |
| expiryDate    | 유효기간                       | date                             |
| status        | 처리 상태                      | enum (초안 / 발송 / 승인 / 거절) |
| totalAmount   | 견적 총액                      | number                           |
| memo          | 비고 및 특이사항               | string (선택)                    |

### InvoiceItem (견적 항목)

| 필드      | 설명                        | 타입/관계    |
| --------- | --------------------------- | ------------ |
| id        | 항목 고유 식별자            | UUID         |
| invoiceId | 소속 견적서 ID              | → Invoice.id |
| itemName  | 품목명                      | string       |
| quantity  | 수량                        | number       |
| unitPrice | 단가                        | number       |
| subtotal  | 소계 (quantity × unitPrice) | number       |

### CompanyProfile (발급자 회사 정보)

환경변수 또는 별도 설정 파일로 관리합니다.

| 필드           | 설명                 | 타입/관계 |
| -------------- | -------------------- | --------- |
| companyName    | 회사명               | string    |
| logoUrl        | 로고 이미지 경로     | string    |
| address        | 사업장 주소          | string    |
| contact        | 연락처 (전화/이메일) | string    |
| businessNumber | 사업자등록번호       | string    |

---

## 기술 스택

### 프론트엔드 프레임워크

- **Next.js 15.5.3** (App Router + Turbopack) - React 풀스택 프레임워크
- **TypeScript 5** - 타입 안전성 보장
- **React 19.1.0** - UI 라이브러리 (동시성 기능 활용)

### 스타일링 & UI

- **TailwindCSS v4** (설정 파일 없는 새 CSS 엔진) - 유틸리티 CSS 프레임워크
- **shadcn/ui (new-york style)** - 고품질 React 컴포넌트 라이브러리
- **Lucide React** - 아이콘 라이브러리

### 폼 & 검증

- **React Hook Form 7.x** - 로그인 폼 상태 관리
- **Zod** - 스키마 검증 라이브러리

### 외부 연동

- **Notion API (@notionhq/client)** - 견적서 데이터 단일 소스
- **Next.js 15 Server Actions** - 서버 사이드 Notion API 호출 (API 키 보호)

### PDF 생성

- **브라우저 Print API + CSS @media print** - 별도 라이브러리 없이 인쇄 레이아웃 활용
- 인쇄 전용 CSS 클래스로 불필요한 UI 요소 숨김 처리

### 배포 & 호스팅

- **Vercel** - Next.js 15 최적화 배포 플랫폼
- **환경변수**: `NOTION_API_KEY`, `NOTION_DATABASE_ID`는 Vercel 환경변수로 관리

### 패키지 관리

- **npm** - 의존성 관리
- **Husky + lint-staged** - 커밋 전 자동 린트/포맷

---

## 정합성 검증

### 기능 명세 -> 페이지 연결 검증

| 기능 ID | 기능명               | 구현 페이지                            | 검증 |
| ------- | -------------------- | -------------------------------------- | ---- |
| F001    | Notion 견적서 조회   | 견적서 목록 페이지, 견적서 상세 페이지 | 통과 |
| F002    | 고유 URL 견적서 접근 | 견적서 상세 페이지                     | 통과 |
| F003    | 견적서 상세 표시     | 견적서 상세 페이지                     | 통과 |
| F004    | 견적서 상태 표시     | 견적서 상세 페이지                     | 통과 |
| F005    | PDF 다운로드         | 견적서 상세 페이지                     | 통과 |
| F010    | 발급자 인증          | 로그인 페이지, 견적서 목록 페이지      | 통과 |
| F011    | 견적서 목록 관리     | 견적서 목록 페이지                     | 통과 |

### 메뉴 구조 -> 페이지 연결 검증

| 메뉴 항목   | 연결 페이지        | 검증 |
| ----------- | ------------------ | ---- |
| 로그인      | 로그인 페이지      | 통과 |
| 견적서 목록 | 견적서 목록 페이지 | 통과 |
| 견적서 상세 | 견적서 상세 페이지 | 통과 |
| 404 처리    | 404 페이지         | 통과 |

### 누락 및 고아 항목 검증

- 기능 명세에만 있고 페이지에서 구현되지 않은 기능: **없음**
- 페이지에만 있고 기능 명세에 없는 기능: **없음**
- 메뉴에만 있고 실제 페이지가 없는 항목: **없음**
